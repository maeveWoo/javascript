<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="external.js" defer></script>
</head>
<body>
<h1>JS가 뭔가요?</h1>
<p>
    JS는 웹 페이지에서 복잡한 기능을 구현할 수 있도록 하는 스크립팅 언어 또는 프로그래밍 언어이다.
</p>

<h2>그래서 어떤 일을 할 수 있나?</h2>
<p>
    클라이언트 사이드 JS 언어 위에 올라가있는 기능들을 알아보자.

    애플리케이션 프로그래밍 인터페이스(API)라고 부르는 이 기능들은 JS 코드에서 사용할 수 있는 강력한 마법을 추가로 제공한다.

    API는 개발자가 직접 구현하기는 어렵거나 불가능한 기능들을 미리 만들어서 제공하는 것이다.

    API는 일반적으로 구 개의 범주로 분류할 수 있다. 3rd party APIs, Browser APIs

    브라우저 API는 웹 브라우저에 내장된 API로, 현재 컴퓨터 환경에 관한 데이터를 제공하거나 여러가지 유용하고 복잡한 일을 수행한다.
</p>
<ul>
    <li>
        <p>
            DOM(Document Object Model) API로 HTML 콘텐츠를 추가, 제거, 변경하고, 동적으로 페이지에 스타일을 추가하는 등 HTML/CSS를 조작할 수 있다.
            페이지 위에 뜨는 팝업창이나, 새로운 콘텐츠가 나타나는 것을 본 적이 있으면 DOM 동작한 것이다.
        </p>
    </li>
    <li>
        <p>
            Geolocation API로 지리정보를 가져올 수 있다. Google 지도에서 여러분의 위치를 찾아 지도에 그릴 수 있는 이유가 바로 이 API다.
        </p>
    </li>
    <li>
        <p>
            Canvas와 WebGL API로 애니메이션을 적용한 2D와 3D 그래픽을 만들 수 있다.
        </p>
    </li>
    <li>
        <p>
            HTMLMediaElement와 WebRTC를 포함하는 오디오와 비디오 API로는 멀티미디어를 사용한 흥미로운 일을 할 수 있다.

            예를 들어 오디오나 비디오를 웹 페이지에서 바로 재생하거나, 여러분의 웹캠으로 비디오를 찍어 다른 사람의 화면에 보여줄 수 있다.
        </p>
    </li>
</ul>
<em>
    구형 브라우저에서는 위 예제 중 많은 수가 동작하지 않는다. 배포시 크로스 브라우저 테스트를 고려하세요.
</em>
<p>
    서드파티 API는 브라우저에 탑재되지 않은 API로, 웹의 어딘가에서 직접 코드와 정보를 찾아야 한다.
</p>

<h2>웹 페이지에서 JS는 어떤 일을 하나요?</h2>
<p>
    브라우저가 웹 페이지를 불러오면, 브라우저는 여러분의 코드(HTML, CSS, JS)를 실행 환경(브라우저 탭)에서 실행한다.

    JS는 DOM API를 통해 HTML과 CSS를 동적으로 수정, 사용자 인터페이스를 업데이트하는 일에 가장 많이 쓴다.

    웹 문서의 코드는 보통 문서 상에서 나타나는 순서 그대로 불러와 실행한다.

    수정하려는 HTML과 CSS 코드보다 JS를 먼저 불러와 실행해버리면 오류가 발생할 수 있다.
</p>

<h2>브라우저 보안</h2>
<p>
    각각의 브라우저 탭은 코드를 실행하기 위한 독립적인 실행환경이다. 대부분의 탭이 서로에게서 완전히 분리된다는 뜻이다.

    이건 중요한 보안 절차이다. 만약 이런 제약이 없으면 해커들이 다른 웹 사이트에서 정보를 훔치는 것을 포함해 여러가지 나쁜 일을 하는 코드를 작성할 것이다.
</p>
<small>두개의 다른 탭 사이에서 코드와 정보를 안전하게 주고받을 수 있는 방법이 있다.</small>

<h2>JS 실행 순서</h2>
<p>
    브라우저가 JS 블록을 마주치면, 일반적으로는 순서대로 위에서 아래로 실행한다.

    순서가 잘못되면 TypeError: para is undefined가 나타날 수 있다.
</p>

<h2>인터프리터와 컴파일러</h2>
<p>
    인터프리터를 사용하는 언어에서는 코드를 위에서 아래로 실행하고, 코드 구동 결과는 즉시 반환된다.

    브라우저에서 JS코드를 실행하기 전에 다른 형태로 변환할 필요가 없다는 점을 기억!

    코드는 프로그래머가 읽을 수 있는 형태로 입력되고, 별도의 처리없이 그대로 실행된다.
</p>
<p>
    반면, 컴파일러를 사용하는 컴파일 언어에서는 컴퓨터가 코드를 실행하기 전에 다른 형태로 변환(컴파일)해야 한다.
    예를들어, C/C++에서는 코드를 컴파일러로 기계언어로 변환하여, 그 결과를 컴퓨터가 실행한다.
    프로그램은 프로그램의 원본 소스 코드에서 생성한 이진 형식(바이너리)으로부터 실행된다.
</p>
<p>
    JS는 가볍고, <strong>인터프리터</strong>를 사용하는 프로그래밍 언어이다.
    기술적인 측면으로 따지자면, 대부분의 모던 JS 인터프리터들은 JIT컴파일이라는 기술을 사용해 성능을 향상하기는 한다.
    스크립트의 실행과 동시에 소스 코드를 더 빠르게 실행할 수 있는 이진 형태로 변환하여 최대한 높은 실행 속도를 얻는 방법이다.
    하지만 <strong>JS는 여전히 인터프리터 언어로 분류된다.</strong> 컴파일을 먼저 해놔야 하는 것이 아니라 런타임에 일어나기 때문이다.
</p>

<h2>서버 사이드와 클라이언트 사이드 코드</h2>
<p>
    클라이언트 사이드 코드는 사용자의 컴퓨터에서 동작하는 코드. 웹 페이지를 방문하면 브라우저가 페이지 내의 클라이언트 사이드 코드를 다운로드하고 실행해서 화면에 띄운다.
    반대로 서버 사이드 코드는 서버에서 동작하는 코드로, 그 실행 결과를 브라우저가 다운로드해서 화면에 띄우게된다.
    클라이언트 사이드 JS와 서버 사이드 언어들 모두 동적이라는 단어로 설명할 수 있다.
</p>

<h2>웹 페이지에 JS를 어떻게 넣나요?</h2>
<p>
    내부 JS, 외부 JS, 인라인 JS 처리기가 있다.

    아래 인라인 JS 처리기 예제를 보자
</p>
<code>
    &lt;button onclick="createParagraph()"&gt;Click me!&lt;/button&gt;
</code>
<p>
    이 방법을 사용하지 말자. JS로 HTML 코드를 물들이는 것은 나쁜 방법일 뿐더러 비효율적이다.
    JS를 적용하려는 모든 버튼마다 일일히 onclick="createParagraph()"를 추가해야 한다.
    대신 addEventListener를 사용하자.
</p>

<h2>스크립트 로딩 전략</h2>
<p>
    스크립트를 적절한 시점에 불러오는 일에는 몇 가지 문제가 있다.
    특히, 내 외부 JS 예제에서는 HTML 본문을 읽기 전에 문서의 헤드에서 JS를 불러와 실행한다.
    JS를 사용해서 DOM을 조작하려고 할 때, 해당 요소를 포함한 HTML 코드보다 JS를 먼저 불러와버리면 올바르게 동작하지 못할 것이다.
</p>
<code>
    document.addEventListener('DOMContentLoaded', () => {
    ...
    });
</code>
<p>
    위 코드는, HTML 본문 전체를 불러와 읽었다는 것을 나타내는 브라우저 DOMContentLoaded 이벤트를 수신하는 수신기이다.

    외부 예제에서는 더 최신 기법을 사용해 문제 발생을 억제한다. <strong>defer</strong>은 특정 브라우저가 script태그를 마주쳐도 그 이후의 HTML 콘텐츠를 계속 불러오도록 지정한다.
</p>
<code>
    &lt;script src="script.js" defer&gt;&lt;/script&gt;
</code>
<p>
    이렇게 하면 스크립트와 HTML을 동시에 불러오므로 오류가 발생하지 않는다.
</p>
<em>
    defer 특성이 오류를 예방하므로, 외부 예제에서는 DOMContentLoaded를 사용하지 않는다.
    내부 예제에서는 defer 방법을 사용하지 않았는데, defer는 외부 스크립트에만 사용할 수 있기 때문이다.
</em>
<p>
    고전적인 방법은 스크립트 요소를 본문의 맨 마지막 닫는 body태그 벓 엎애 배치하는 것이다.
    그러면 모든 HTML을 읽은 후에 스크립트를 불러오게 된다.
    이 방법의 문제는 HTML DOM을 모두 불러오기 전에는 스크립트의 로딩과 분석이 완전히 중단된다는 점이다.
    그래서 많은 스크립트를 포함하는 대형 사이트에서는 성능이 저하될 수 있다.
</p>
<a href="https://ko.javascript.info/script-async-defer">defer, async 스크립트 참고 문서</a>

<h2>async</h2>
<p>
    스크립트 중단 문제를 해결할 수 있는 기능에는 사실 두 가지가 있다.
    <strong>async</strong>와 <strong>defer</strong>이다.
    차이점은 무엇일까?
</p>
<p>
    <strong>async</strong>특성을 지정하면 스크립트를 가져오는 동안 페이지 로딩을 중단하지 않는다.
    그러나 스크립트 다운로드가  끝나면 바로 실행되는데, 실행 도중에는 페이지 렌더링이 중단된다.
    스크립트의 실행 순서를 보장할 방법은 없다.
    따라서 <strong>async</strong>는 다른 스크립트에 의존하지 않는 독립 스크립트에 사용해야 한다.
</p>
<p>
    <strong>defer</strong> 특성을 지정한 스크립트는 페이지 내에 배치한 순서대로 불러오게 된다.
    또한 페이지 콘텐츠를 모두 불러오기 전까지는 실행하지 않으므로, 페이지 요소를 수정하거나 추가하는 등 DOM 작업을 기대하는 스크립트에 유용하다.
</p>
<img src="../img/async-defer.jpeg" alt="async defer 페이지 동작 방식">
<p>
    <strong>async</strong>는 다수의 백그라운드 스크립트를 최대한 빠르게 불러와야 할 때 사용해야한다.
    예를들어 웹 게임을 시작했을 때 사용할 게임 데이터는 곧 필요하긴 하지만 지금 당장 필요한 것은 아니므로, 게임 데이터를 불러온다고 인트로 화면과 타이틀, 메인 메뉴 표시를 중단하지 않을 수 있다.
    <br>
    요약하자면,
</p>
<ul>
    <li>
        <p>
            async와 defer 모두, 브라우저가 페이지의 다른 내용(DOM 등등)을 불러오는 동안 스크립트를 별도 스레드에서 불러오게 만든다.
            덕분에 스크립트를 가져오는 동안 페이지 로딩이 중단되지 않는다.
        </p>
    </li>
    <li>
        <p>
            async 특성을 지정한 스크립트는 다운로드가 끝나는 즉시 실행한다. 실행은 현재 페이지 렌더링을 중단하며, 실행 순서는 보장되지 않는다.
        </p>
    </li>
    <li>
        <p>
            defer 특성을 지정한 스크립트는 순서를 유지한 채로 가져오며 모든 콘텐츠를 다 불러온 이후에 실행한다.
        </p>
    </li>
    <li>
        <p>
            의존성 없는 스크립트를 불러온 즉시 실행하려면 async를 사용.
        </p>
    </li>
    <li>
        <p>
            다른 스크립트에 의존하거나 DOM 로딩이 필요한 스크립트에는 defer를 사용하고, 원하는 순서에 맞춰서 script 태그 요소를 배치하세요.
        </p>
    </li>
</ul>
<h2>주석</h2>
<p>
    // 한 줄 주석
    /*
    여러줄 주석
    */
</p>
</body>
</html>